-- USED_GOODS_BOARD : 중고 거래 게시판 정보
-- USED_GOODS_USER : 중고 거래 게시판 사용자 정보
-- 완료된 중고 거래의 총금액이 70만원 이상인 사람의 정보 조회
SELECT U.USER_ID, U.NICKNAME, SUM(B.PRICE) TOTAL_SALES
FROM USED_GOODS_BOARD B
JOIN USED_GOODS_USER U
ON B.WRITER_ID = U.USER_ID
WHERE B.STATUS = 'DONE'
GROUP BY U.USER_ID, U.NICKNAME
HAVING SUM(B.PRICE) >= 700000
ORDER BY TOTAL_SALES;