-- BOOK : 판매중인 도서 정보
-- AUTHOR : 저자 정보
-- BOOK_SALES : 도서의 날짜 별 판매량 정보
-- 2022년 1월의 도서 판매 데이터를 기준으로 저자 별, 카테고리 별 매출액을 구해라


SELECT 
  B.AUTHOR_ID, 
  A.AUTHOR_NAME, 
  B.CATEGORY, 
  SUM(BS.SALES * B.PRICE) TOTAL_SALES
FROM BOOK B
JOIN BOOK_SALES BS
ON B.BOOK_ID = BS.BOOK_ID
JOIN AUTHOR A
ON B.AUTHOR_ID = A.AUTHOR_ID
WHERE TO_CHAR(BS.SALES_DATE, 'YYYYMM') = '202201'
GROUP BY B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY
ORDER BY B.AUTHOR_ID, B.CATEGORY DESC;